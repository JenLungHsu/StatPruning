DALI "gpu" variant
pip_train.epoch_size("Reader"):1281167
/home/hsujenlung/miniconda3/envs/Roy/lib/python3.8/site-packages/nvidia/dali/plugin/base_iterator.py:208: Warning: Please set `reader_name` and don't set last_batch_padded and size manually whenever possible. This may lead, in some situations, to missing some samples or returning duplicated ones. Check the Sharding section of the documentation for more details.
  _iterator_deprecation_warning()
current lr 1.00000e-04
Epoch: [0][0/6406]	Time 4.087 (4.087)	Data 0.001 (0.001)	Loss 2.5324 (2.5324)	Prec@1 75.000 (75.000)Prec@5 90.500 (90.500)
Epoch: [0][50/6406]	Time 0.368 (0.442)	Data 0.001 (0.001)	Loss 2.3877 (2.4726)	Prec@1 80.000 (75.833)Prec@5 93.000 (91.176)
Epoch: [0][100/6406]	Time 0.380 (0.408)	Data 0.001 (0.001)	Loss 2.3507 (2.4457)	Prec@1 80.000 (75.896)Prec@5 93.500 (91.262)
Epoch: [0][150/6406]	Time 0.408 (0.403)	Data 0.001 (0.001)	Loss 2.3080 (2.4171)	Prec@1 76.000 (76.205)Prec@5 91.000 (91.354)
Epoch: [0][200/6406]	Time 0.407 (0.404)	Data 0.001 (0.001)	Loss 2.2412 (2.4025)	Prec@1 78.000 (76.211)Prec@5 92.500 (91.204)
Epoch: [0][250/6406]	Time 0.402 (0.404)	Data 0.001 (0.001)	Loss 2.2302 (2.3910)	Prec@1 77.000 (76.028)Prec@5 91.000 (91.050)
Epoch: [0][300/6406]	Time 0.409 (0.405)	Data 0.001 (0.001)	Loss 2.4751 (2.3783)	Prec@1 72.000 (75.831)Prec@5 89.000 (91.002)
Epoch: [0][350/6406]	Time 0.425 (0.406)	Data 0.001 (0.001)	Loss 2.1142 (2.3630)	Prec@1 81.000 (75.852)Prec@5 94.500 (91.031)
Epoch: [0][400/6406]	Time 0.407 (0.407)	Data 0.001 (0.001)	Loss 2.2472 (2.3517)	Prec@1 79.500 (75.779)Prec@5 93.000 (91.006)
Epoch: [0][450/6406]	Time 0.413 (0.407)	Data 0.001 (0.001)	Loss 2.1649 (2.3409)	Prec@1 77.000 (75.749)Prec@5 93.000 (91.010)
Epoch: [0][500/6406]	Time 0.412 (0.408)	Data 0.001 (0.001)	Loss 2.1995 (2.3311)	Prec@1 77.000 (75.725)Prec@5 90.500 (91.016)
Epoch: [0][550/6406]	Time 0.446 (0.409)	Data 0.001 (0.001)	Loss 2.1663 (2.3224)	Prec@1 80.000 (75.750)Prec@5 91.500 (91.028)
Epoch: [0][600/6406]	Time 0.423 (0.410)	Data 0.001 (0.001)	Loss 2.2122 (2.3153)	Prec@1 79.000 (75.668)Prec@5 91.000 (91.022)
Epoch: [0][650/6406]	Time 0.437 (0.411)	Data 0.001 (0.001)	Loss 2.1803 (2.3091)	Prec@1 75.000 (75.636)Prec@5 94.000 (91.008)
Epoch: [0][700/6406]	Time 0.408 (0.412)	Data 0.001 (0.001)	Loss 2.2385 (2.3037)	Prec@1 75.000 (75.581)Prec@5 90.000 (90.997)
Epoch: [0][750/6406]	Time 0.408 (0.412)	Data 0.001 (0.001)	Loss 2.2542 (2.2968)	Prec@1 75.000 (75.621)Prec@5 90.500 (91.032)
Epoch: [0][800/6406]	Time 0.421 (0.412)	Data 0.001 (0.001)	Loss 2.1624 (2.2913)	Prec@1 75.500 (75.616)Prec@5 92.000 (91.030)
Epoch: [0][850/6406]	Time 0.448 (0.412)	Data 0.001 (0.001)	Loss 1.9746 (2.2850)	Prec@1 82.000 (75.610)Prec@5 94.500 (91.056)
Epoch: [0][900/6406]	Time 0.435 (0.413)	Data 0.001 (0.001)	Loss 2.1818 (2.2806)	Prec@1 77.000 (75.643)Prec@5 91.500 (91.046)
Epoch: [0][950/6406]	Time 0.463 (0.413)	Data 0.001 (0.001)	Loss 2.2861 (2.2759)	Prec@1 72.500 (75.642)Prec@5 88.500 (91.062)
Epoch: [0][1000/6406]	Time 0.415 (0.413)	Data 0.001 (0.001)	Loss 2.2287 (2.2718)	Prec@1 77.500 (75.647)Prec@5 87.500 (91.069)
Epoch: [0][1050/6406]	Time 0.407 (0.413)	Data 0.000 (0.001)	Loss 2.3250 (2.2682)	Prec@1 72.500 (75.644)Prec@5 87.000 (91.081)
Epoch: [0][1100/6406]	Time 0.410 (0.413)	Data 0.001 (0.001)	Loss 2.1243 (2.2649)	Prec@1 76.500 (75.628)Prec@5 93.500 (91.074)
Epoch: [0][1150/6406]	Time 0.408 (0.412)	Data 0.001 (0.001)	Loss 2.0958 (2.2603)	Prec@1 75.000 (75.659)Prec@5 92.000 (91.101)
Epoch: [0][1200/6406]	Time 0.408 (0.412)	Data 0.001 (0.001)	Loss 2.2805 (2.2559)	Prec@1 70.500 (75.697)Prec@5 89.000 (91.123)
Epoch: [0][1250/6406]	Time 0.406 (0.412)	Data 0.001 (0.001)	Loss 2.1552 (2.2531)	Prec@1 78.500 (75.697)Prec@5 90.000 (91.118)
Epoch: [0][1300/6406]	Time 0.407 (0.412)	Data 0.001 (0.001)	Loss 2.0959 (2.2501)	Prec@1 75.500 (75.693)Prec@5 95.000 (91.131)
Epoch: [0][1350/6406]	Time 0.402 (0.412)	Data 0.001 (0.001)	Loss 2.3683 (2.2470)	Prec@1 71.500 (75.707)Prec@5 87.000 (91.142)
Epoch: [0][1400/6406]	Time 0.407 (0.412)	Data 0.001 (0.001)	Loss 2.1175 (2.2454)	Prec@1 79.000 (75.681)Prec@5 91.000 (91.132)
Epoch: [0][1450/6406]	Time 0.400 (0.412)	Data 0.001 (0.001)	Loss 2.1306 (2.2435)	Prec@1 75.500 (75.660)Prec@5 94.000 (91.128)
Epoch: [0][1500/6406]	Time 0.406 (0.411)	Data 0.001 (0.001)	Loss 2.1097 (2.2411)	Prec@1 79.000 (75.663)Prec@5 92.000 (91.128)
Epoch: [0][1550/6406]	Time 0.406 (0.411)	Data 0.001 (0.001)	Loss 2.2903 (2.2384)	Prec@1 71.500 (75.708)Prec@5 90.500 (91.142)
Epoch: [0][1600/6406]	Time 0.404 (0.411)	Data 0.001 (0.001)	Loss 2.1497 (2.2360)	Prec@1 74.500 (75.707)Prec@5 91.000 (91.154)
Epoch: [0][1650/6406]	Time 0.403 (0.411)	Data 0.001 (0.001)	Loss 2.2836 (2.2340)	Prec@1 71.000 (75.709)Prec@5 88.000 (91.154)
Epoch: [0][1700/6406]	Time 0.408 (0.411)	Data 0.001 (0.001)	Loss 2.2078 (2.2314)	Prec@1 73.500 (75.729)Prec@5 91.000 (91.168)
Epoch: [0][1750/6406]	Time 0.405 (0.411)	Data 0.001 (0.001)	Loss 2.1039 (2.2291)	Prec@1 77.500 (75.731)Prec@5 93.500 (91.183)
Epoch: [0][1800/6406]	Time 0.400 (0.411)	Data 0.001 (0.001)	Loss 2.1490 (2.2272)	Prec@1 76.000 (75.737)Prec@5 91.000 (91.184)
Epoch: [0][1850/6406]	Time 0.404 (0.411)	Data 0.001 (0.001)	Loss 2.2942 (2.2249)	Prec@1 75.500 (75.757)Prec@5 89.500 (91.197)
Epoch: [0][1900/6406]	Time 0.404 (0.411)	Data 0.001 (0.001)	Loss 2.2392 (2.2229)	Prec@1 73.500 (75.765)Prec@5 90.500 (91.205)
Epoch: [0][1950/6406]	Time 0.398 (0.411)	Data 0.001 (0.001)	Loss 2.1039 (2.2213)	Prec@1 75.500 (75.773)Prec@5 93.000 (91.199)
Epoch: [0][2000/6406]	Time 0.405 (0.410)	Data 0.001 (0.001)	Loss 2.0833 (2.2194)	Prec@1 76.000 (75.775)Prec@5 92.500 (91.204)
Epoch: [0][2050/6406]	Time 0.408 (0.410)	Data 0.001 (0.001)	Loss 2.0630 (2.2177)	Prec@1 78.000 (75.788)Prec@5 91.000 (91.211)
Epoch: [0][2100/6406]	Time 0.403 (0.410)	Data 0.001 (0.001)	Loss 2.2959 (2.2162)	Prec@1 74.000 (75.792)Prec@5 88.500 (91.213)
Epoch: [0][2150/6406]	Time 0.401 (0.410)	Data 0.001 (0.001)	Loss 2.1817 (2.2146)	Prec@1 76.500 (75.792)Prec@5 91.000 (91.211)
Epoch: [0][2200/6406]	Time 0.403 (0.410)	Data 0.001 (0.001)	Loss 2.1701 (2.2129)	Prec@1 76.500 (75.805)Prec@5 90.500 (91.215)
Epoch: [0][2250/6406]	Time 0.404 (0.410)	Data 0.001 (0.001)	Loss 1.9516 (2.2111)	Prec@1 82.000 (75.822)Prec@5 95.500 (91.226)
Epoch: [0][2300/6406]	Time 0.424 (0.410)	Data 0.001 (0.001)	Loss 2.1526 (2.2097)	Prec@1 74.500 (75.825)Prec@5 92.000 (91.236)
Epoch: [0][2350/6406]	Time 0.401 (0.410)	Data 0.001 (0.001)	Loss 2.1411 (2.2089)	Prec@1 76.500 (75.796)Prec@5 90.000 (91.229)
Epoch: [0][2400/6406]	Time 0.407 (0.410)	Data 0.001 (0.001)	Loss 2.2194 (2.2071)	Prec@1 76.000 (75.813)Prec@5 88.500 (91.240)
Epoch: [0][2450/6406]	Time 0.399 (0.410)	Data 0.001 (0.001)	Loss 2.2807 (2.2055)	Prec@1 70.500 (75.827)Prec@5 87.500 (91.248)
Epoch: [0][2500/6406]	Time 0.403 (0.410)	Data 0.001 (0.001)	Loss 2.1434 (2.2040)	Prec@1 75.500 (75.844)Prec@5 91.500 (91.249)
Epoch: [0][2550/6406]	Time 0.400 (0.410)	Data 0.001 (0.001)	Loss 2.1469 (2.2027)	Prec@1 75.000 (75.842)Prec@5 91.000 (91.255)
Epoch: [0][2600/6406]	Time 0.395 (0.410)	Data 0.000 (0.001)	Loss 2.1278 (2.2013)	Prec@1 75.000 (75.856)Prec@5 90.000 (91.262)
Epoch: [0][2650/6406]	Time 0.405 (0.410)	Data 0.001 (0.001)	Loss 2.2887 (2.1997)	Prec@1 69.500 (75.869)Prec@5 88.500 (91.274)
Epoch: [0][2700/6406]	Time 0.423 (0.410)	Data 0.001 (0.001)	Loss 2.1313 (2.1982)	Prec@1 76.000 (75.879)Prec@5 92.000 (91.281)
Epoch: [0][2750/6406]	Time 0.401 (0.410)	Data 0.001 (0.001)	Loss 2.2185 (2.1971)	Prec@1 74.000 (75.885)Prec@5 89.500 (91.279)
Epoch: [0][2800/6406]	Time 0.403 (0.410)	Data 0.001 (0.001)	Loss 2.2268 (2.1954)	Prec@1 76.000 (75.906)Prec@5 92.000 (91.291)
Epoch: [0][2850/6406]	Time 0.408 (0.409)	Data 0.001 (0.001)	Loss 2.0916 (2.1943)	Prec@1 77.000 (75.912)Prec@5 92.500 (91.295)
Epoch: [0][2900/6406]	Time 0.452 (0.410)	Data 0.001 (0.001)	Loss 2.2518 (2.1931)	Prec@1 73.500 (75.921)Prec@5 88.500 (91.296)
Epoch: [0][2950/6406]	Time 0.414 (0.410)	Data 0.001 (0.001)	Loss 2.1489 (2.1915)	Prec@1 72.000 (75.932)Prec@5 91.000 (91.310)
Epoch: [0][3000/6406]	Time 0.420 (0.410)	Data 0.001 (0.001)	Loss 2.1728 (2.1904)	Prec@1 73.000 (75.940)Prec@5 93.000 (91.316)
Epoch: [0][3050/6406]	Time 0.416 (0.410)	Data 0.001 (0.001)	Loss 2.0257 (2.1890)	Prec@1 78.000 (75.961)Prec@5 94.500 (91.321)
Epoch: [0][3100/6406]	Time 0.415 (0.410)	Data 0.001 (0.001)	Loss 2.0497 (2.1876)	Prec@1 78.000 (75.969)Prec@5 94.500 (91.331)
Epoch: [0][3150/6406]	Time 0.413 (0.410)	Data 0.001 (0.001)	Loss 2.1421 (2.1866)	Prec@1 76.500 (75.981)Prec@5 90.000 (91.331)
Epoch: [0][3200/6406]	Time 0.412 (0.410)	Data 0.001 (0.001)	Loss 1.9466 (2.1853)	Prec@1 81.000 (76.002)Prec@5 94.500 (91.337)
Epoch: [0][3250/6406]	Time 0.420 (0.410)	Data 0.001 (0.001)	Loss 2.1479 (2.1844)	Prec@1 79.500 (76.008)Prec@5 89.500 (91.335)
Epoch: [0][3300/6406]	Time 0.403 (0.410)	Data 0.001 (0.001)	Loss 2.1035 (2.1832)	Prec@1 76.500 (76.016)Prec@5 94.000 (91.342)
Epoch: [0][3350/6406]	Time 0.403 (0.410)	Data 0.001 (0.001)	Loss 2.1812 (2.1822)	Prec@1 70.500 (76.019)Prec@5 92.000 (91.343)
Epoch: [0][3400/6406]	Time 0.410 (0.410)	Data 0.001 (0.001)	Loss 2.1996 (2.1811)	Prec@1 78.500 (76.030)Prec@5 90.000 (91.346)
Epoch: [0][3450/6406]	Time 0.407 (0.410)	Data 0.001 (0.001)	Loss 1.9925 (2.1800)	Prec@1 77.500 (76.034)Prec@5 95.000 (91.350)
Epoch: [0][3500/6406]	Time 0.413 (0.411)	Data 0.001 (0.001)	Loss 2.1293 (2.1792)	Prec@1 75.500 (76.039)Prec@5 90.000 (91.351)
Epoch: [0][3550/6406]	Time 0.412 (0.411)	Data 0.001 (0.001)	Loss 2.1060 (2.1783)	Prec@1 78.000 (76.047)Prec@5 89.500 (91.355)
Epoch: [0][3600/6406]	Time 0.412 (0.411)	Data 0.001 (0.001)	Loss 2.0850 (2.1771)	Prec@1 75.000 (76.062)Prec@5 91.500 (91.364)
Epoch: [0][3650/6406]	Time 0.412 (0.411)	Data 0.001 (0.001)	Loss 2.0484 (2.1758)	Prec@1 78.500 (76.078)Prec@5 92.500 (91.373)
Epoch: [0][3700/6406]	Time 0.426 (0.411)	Data 0.001 (0.001)	Loss 2.2093 (2.1748)	Prec@1 76.500 (76.086)Prec@5 88.500 (91.378)
Epoch: [0][3750/6406]	Time 0.446 (0.411)	Data 0.001 (0.001)	Loss 2.0702 (2.1736)	Prec@1 77.000 (76.103)Prec@5 91.000 (91.391)
Epoch: [0][3800/6406]	Time 0.414 (0.411)	Data 0.001 (0.001)	Loss 2.1421 (2.1728)	Prec@1 75.000 (76.108)Prec@5 92.000 (91.391)
Epoch: [0][3850/6406]	Time 0.409 (0.411)	Data 0.001 (0.001)	Loss 2.0656 (2.1720)	Prec@1 80.000 (76.121)Prec@5 92.000 (91.394)
Epoch: [0][3900/6406]	Time 0.418 (0.411)	Data 0.001 (0.001)	Loss 1.9441 (2.1713)	Prec@1 80.500 (76.123)Prec@5 94.000 (91.395)
Epoch: [0][3950/6406]	Time 0.409 (0.411)	Data 0.001 (0.001)	Loss 2.1067 (2.1704)	Prec@1 75.500 (76.132)Prec@5 92.000 (91.397)
Epoch: [0][4000/6406]	Time 0.414 (0.411)	Data 0.001 (0.001)	Loss 1.9812 (2.1695)	Prec@1 80.000 (76.142)Prec@5 92.000 (91.401)
Epoch: [0][4050/6406]	Time 0.412 (0.411)	Data 0.001 (0.001)	Loss 2.0591 (2.1687)	Prec@1 77.500 (76.147)Prec@5 93.500 (91.402)
Epoch: [0][4100/6406]	Time 0.416 (0.411)	Data 0.001 (0.001)	Loss 2.1335 (2.1680)	Prec@1 75.000 (76.151)Prec@5 93.000 (91.403)
Epoch: [0][4150/6406]	Time 0.409 (0.411)	Data 0.001 (0.001)	Loss 2.0665 (2.1669)	Prec@1 77.500 (76.165)Prec@5 93.000 (91.408)
Epoch: [0][4200/6406]	Time 0.409 (0.412)	Data 0.001 (0.001)	Loss 2.0757 (2.1662)	Prec@1 78.500 (76.171)Prec@5 92.500 (91.413)
Epoch: [0][4250/6406]	Time 0.431 (0.411)	Data 0.001 (0.001)	Loss 2.0262 (2.1656)	Prec@1 75.500 (76.171)Prec@5 93.500 (91.416)
Epoch: [0][4300/6406]	Time 0.417 (0.412)	Data 0.001 (0.001)	Loss 2.0419 (2.1649)	Prec@1 77.500 (76.175)Prec@5 91.000 (91.414)
Epoch: [0][4350/6406]	Time 0.416 (0.412)	Data 0.001 (0.001)	Loss 2.1921 (2.1641)	Prec@1 77.000 (76.188)Prec@5 90.500 (91.417)
Epoch: [0][4400/6406]	Time 0.413 (0.412)	Data 0.001 (0.001)	Loss 1.9947 (2.1630)	Prec@1 79.000 (76.205)Prec@5 95.000 (91.425)
Epoch: [0][4450/6406]	Time 0.416 (0.412)	Data 0.001 (0.001)	Loss 2.2602 (2.1624)	Prec@1 70.000 (76.204)Prec@5 88.500 (91.424)
Epoch: [0][4500/6406]	Time 0.408 (0.412)	Data 0.001 (0.001)	Loss 1.9495 (2.1615)	Prec@1 80.000 (76.214)Prec@5 94.500 (91.428)
Epoch: [0][4550/6406]	Time 0.413 (0.412)	Data 0.001 (0.001)	Loss 2.0121 (2.1604)	Prec@1 79.500 (76.228)Prec@5 92.500 (91.436)
Epoch: [0][4600/6406]	Time 0.407 (0.412)	Data 0.001 (0.001)	Loss 2.1784 (2.1597)	Prec@1 76.000 (76.231)Prec@5 91.000 (91.440)
Epoch: [0][4650/6406]	Time 0.415 (0.412)	Data 0.001 (0.001)	Loss 2.0516 (2.1590)	Prec@1 75.000 (76.234)Prec@5 92.000 (91.445)
Epoch: [0][4700/6406]	Time 0.469 (0.412)	Data 0.001 (0.001)	Loss 2.2539 (2.1582)	Prec@1 74.000 (76.242)Prec@5 88.500 (91.451)
Traceback (most recent call last):
  File "trainer_imagenet_resnet50.py", line 552, in <module>
    main()
  File "trainer_imagenet_resnet50.py", line 358, in main
    train(train_loader, model, criterion_smooth, optimizer, epoch)
  File "trainer_imagenet_resnet50.py", line 397, in train
    for i, batch in enumerate(train_loader):
  File "/home/hsujenlung/miniconda3/envs/Roy/lib/python3.8/site-packages/nvidia/dali/plugin/pytorch/__init__.py", line 180, in __next__
    outputs = self._get_outputs()
  File "/home/hsujenlung/miniconda3/envs/Roy/lib/python3.8/site-packages/nvidia/dali/plugin/base_iterator.py", line 385, in _get_outputs
    outputs.append(p.share_outputs())
  File "/home/hsujenlung/miniconda3/envs/Roy/lib/python3.8/site-packages/nvidia/dali/pipeline.py", line 1297, in share_outputs
    return self._pipe.ShareOutputs(types._raw_cuda_stream_ptr(cuda_stream))
RuntimeError: Critical error in pipeline:
Error in MIXED operator `nvidia.dali.ops.decoders.Image`,
which was used in the pipeline definition with the following traceback:

  File "/home/hsujenlung/miniconda3/envs/Roy/lib/python3.8/site-packages/nvidia/dali/pipeline.py", line 819, in _build_graph
    outputs = define_graph()
  File "/ssd5/Roy/pytorch_resnet_cifar10-master/ImageNet_dali.py", line 24, in define_graph
    images = self.decode(self.jpegs)

encountered:

Error in thread 8: nvJPEG error (5): The user-provided allocator functions, for either memory allocation or for releasing the memory, returned a non-zero code.
Details:
n04404412/n04404412_30646.JPEG
Current pipeline object is no longer valid.
